apps: {
 key: "PetShopApi"
 value: {
  name: {
   part: "PetShopApi"
  }
  attrs: {
   key: "package"
   value: {
    s: "io.sysl.demo.petshop.api"
    source_context: {
     file: "tests/petshop.sysl"
     start: {
      line: 36
      col: 12
     }
     end: {
      line: 36
      col: 46
     }
    }
    source_contexts: {
     file: "tests/petshop.sysl"
     start: {
      line: 36
      col: 12
     }
     end: {
      line: 36
      col: 46
     }
    }
   }
  }
  endpoints: {
   key: "GET /petshop"
   value: {
    name: "GET /petshop"
    attrs: {
     key: "patterns"
     value: {
      a: {
       elt: {
        s: "rest"
       }
      }
     }
    }
    stmt: {
     ret: {
      payload: "ok <: PetShop"
     }
     source_context: {
      file: "tests/petshop.sysl"
      start: {
       line: 39
       col: 12
      }
      end: {
       line: 39
       col: 32
      }
     }
     source_contexts: {
      file: "tests/petshop.sysl"
      start: {
       line: 39
       col: 12
      }
      end: {
       line: 39
       col: 32
      }
     }
    }
    rest_params: {
     method: GET
     path: "/petshop"
    }
    source_context: {
     file: "tests/petshop.sysl"
     start: {
      line: 38
      col: 8
     }
     end: {
      line: 41
      col: 5
     }
    }
    source_contexts: {
     file: "tests/petshop.sysl"
     start: {
      line: 38
      col: 8
     }
     end: {
      line: 41
      col: 5
     }
    }
   }
  }
  types: {
   key: "Breed"
   value: {
    tuple: {
     attr_defs: {
      key: "avgLifespan"
      value: {
       primitive: DECIMAL
       opt: true
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 55
         col: 8
        }
        end: {
         line: 55
         col: 31
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 55
         col: 8
        }
        end: {
         line: 55
         col: 31
        }
       }
      }
     }
     attr_defs: {
      key: "index"
      value: {
       primitive: INT
       attrs: {
        key: "patterns"
        value: {
         a: {
          elt: {
           s: "xml_attribute"
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 56
             col: 22
            }
            end: {
             line: 56
             col: 36
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 56
             col: 22
            }
            end: {
             line: 56
             col: 36
            }
           }
          }
         }
        }
       }
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 56
         col: 8
        }
        end: {
         line: 56
         col: 37
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 56
         col: 8
        }
        end: {
         line: 56
         col: 37
        }
       }
      }
     }
     attr_defs: {
      key: "name"
      value: {
       primitive: STRING
       opt: true
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 52
         col: 8
        }
        end: {
         line: 52
         col: 23
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 52
         col: 8
        }
        end: {
         line: 52
         col: 23
        }
       }
      }
     }
     attr_defs: {
      key: "pets"
      value: {
       set: {
        type_ref: {
         context: {
          appname: {
           part: "PetShopApi"
          }
          path: "Breed"
         }
         ref: {
          path: "Pet"
         }
        }
        source_context: {
         file: "tests/petshop.sysl"
         start: {
          line: 54
          col: 8
         }
         end: {
          line: 54
          col: 26
         }
        }
        source_contexts: {
         file: "tests/petshop.sysl"
         start: {
          line: 54
          col: 8
         }
         end: {
          line: 54
          col: 26
         }
        }
       }
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 54
         col: 8
        }
        end: {
         line: 54
         col: 26
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 54
         col: 8
        }
        end: {
         line: 54
         col: 26
        }
       }
      }
     }
     attr_defs: {
      key: "species"
      value: {
       primitive: STRING
       opt: true
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 53
         col: 8
        }
        end: {
         line: 53
         col: 26
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 53
         col: 8
        }
        end: {
         line: 53
         col: 26
        }
       }
      }
     }
    }
    source_context: {
     file: "tests/petshop.sysl"
     start: {
      line: 51
      col: 4
     }
     end: {
      line: 56
      col: 36
     }
    }
    source_contexts: {
     file: "tests/petshop.sysl"
     start: {
      line: 51
      col: 4
     }
     end: {
      line: 56
      col: 36
     }
    }
   }
  }
  types: {
   key: "Employee"
   value: {
    tuple: {
     attr_defs: {
      key: "dob"
      value: {
       primitive: DATE
       opt: true
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 48
         col: 8
        }
        end: {
         line: 48
         col: 20
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 48
         col: 8
        }
        end: {
         line: 48
         col: 20
        }
       }
      }
     }
     attr_defs: {
      key: "index"
      value: {
       primitive: INT
       attrs: {
        key: "patterns"
        value: {
         a: {
          elt: {
           s: "xml_attribute"
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 49
             col: 22
            }
            end: {
             line: 49
             col: 36
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 49
             col: 22
            }
            end: {
             line: 49
             col: 36
            }
           }
          }
         }
        }
       }
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 49
         col: 8
        }
        end: {
         line: 49
         col: 37
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 49
         col: 8
        }
        end: {
         line: 49
         col: 37
        }
       }
      }
     }
     attr_defs: {
      key: "name"
      value: {
       primitive: STRING
       opt: true
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 47
         col: 8
        }
        end: {
         line: 47
         col: 23
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 47
         col: 8
        }
        end: {
         line: 47
         col: 23
        }
       }
      }
     }
    }
    source_context: {
     file: "tests/petshop.sysl"
     start: {
      line: 46
      col: 4
     }
     end: {
      line: 49
      col: 36
     }
    }
    source_contexts: {
     file: "tests/petshop.sysl"
     start: {
      line: 46
      col: 4
     }
     end: {
      line: 49
      col: 36
     }
    }
   }
  }
  types: {
   key: "Pet"
   value: {
    tuple: {
     attr_defs: {
      key: "dob"
      value: {
       primitive: DATE
       opt: true
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 60
         col: 8
        }
        end: {
         line: 60
         col: 20
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 60
         col: 8
        }
        end: {
         line: 60
         col: 20
        }
       }
      }
     }
     attr_defs: {
      key: "legRank"
      value: {
       primitive: INT
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 62
         col: 8
        }
        end: {
         line: 62
         col: 22
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 62
         col: 8
        }
        end: {
         line: 62
         col: 22
        }
       }
      }
     }
     attr_defs: {
      key: "name"
      value: {
       primitive: STRING
       opt: true
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 59
         col: 8
        }
        end: {
         line: 59
         col: 23
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 59
         col: 8
        }
        end: {
         line: 59
         col: 23
        }
       }
      }
     }
     attr_defs: {
      key: "numLegs"
      value: {
       primitive: INT
       opt: true
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 61
         col: 8
        }
        end: {
         line: 61
         col: 23
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 61
         col: 8
        }
        end: {
         line: 61
         col: 23
        }
       }
      }
     }
    }
    source_context: {
     file: "tests/petshop.sysl"
     start: {
      line: 58
      col: 4
     }
     end: {
      line: 62
      col: 22
     }
    }
    source_contexts: {
     file: "tests/petshop.sysl"
     start: {
      line: 58
      col: 4
     }
     end: {
      line: 62
      col: 22
     }
    }
   }
  }
  types: {
   key: "PetShop"
   value: {
    tuple: {
     attr_defs: {
      key: "breeds"
      value: {
       set: {
        type_ref: {
         context: {
          appname: {
           part: "PetShopApi"
          }
          path: "PetShop"
         }
         ref: {
          path: "Breed"
         }
        }
        source_context: {
         file: "tests/petshop.sysl"
         start: {
          line: 43
          col: 8
         }
         end: {
          line: 43
          col: 30
         }
        }
        source_contexts: {
         file: "tests/petshop.sysl"
         start: {
          line: 43
          col: 8
         }
         end: {
          line: 43
          col: 30
         }
        }
       }
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 43
         col: 8
        }
        end: {
         line: 43
         col: 30
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 43
         col: 8
        }
        end: {
         line: 43
         col: 30
        }
       }
      }
     }
     attr_defs: {
      key: "employees"
      value: {
       set: {
        type_ref: {
         context: {
          appname: {
           part: "PetShopApi"
          }
          path: "PetShop"
         }
         ref: {
          path: "Employee"
         }
        }
        source_context: {
         file: "tests/petshop.sysl"
         start: {
          line: 42
          col: 8
         }
         end: {
          line: 42
          col: 36
         }
        }
        source_contexts: {
         file: "tests/petshop.sysl"
         start: {
          line: 42
          col: 8
         }
         end: {
          line: 42
          col: 36
         }
        }
       }
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 42
         col: 8
        }
        end: {
         line: 42
         col: 36
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 42
         col: 8
        }
        end: {
         line: 42
         col: 36
        }
       }
      }
     }
     attr_defs: {
      key: "numLegs"
      value: {
       primitive: INT
       opt: true
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 44
         col: 8
        }
        end: {
         line: 44
         col: 23
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 44
         col: 8
        }
        end: {
         line: 44
         col: 23
        }
       }
      }
     }
    }
    source_context: {
     file: "tests/petshop.sysl"
     start: {
      line: 41
      col: 4
     }
     end: {
      line: 44
      col: 23
     }
    }
    source_contexts: {
     file: "tests/petshop.sysl"
     start: {
      line: 41
      col: 4
     }
     end: {
      line: 44
      col: 23
     }
    }
   }
  }
  source_context: {
   file: "tests/petshop.sysl"
   start: {
    line: 36
   }
   end: {
    line: 62
    col: 22
   }
  }
  source_contexts: {
   file: "tests/petshop.sysl"
   start: {
    line: 36
   }
   end: {
    line: 62
    col: 22
   }
  }
 }
}
apps: {
 key: "PetShopApiToModel"
 value: {
  name: {
   part: "PetShopApiToModel"
  }
  attrs: {
   key: "package"
   value: {
    s: "io.sysl.demo.petshop.views"
    source_context: {
     file: "tests/petshop.sysl"
     start: {
      line: 123
      col: 19
     }
     end: {
      line: 123
      col: 55
     }
    }
    source_contexts: {
     file: "tests/petshop.sysl"
     start: {
      line: 123
      col: 19
     }
     end: {
      line: 123
      col: 55
     }
    }
   }
  }
  types: {
   key: "AnonType_0__"
   value: {
    tuple: {
     attr_defs: {
      key: "breed"
      value: {
       type_ref: {
        context: {
         appname: {
          part: "PetShopApiToModel"
         }
         path: "AnonType_0__"
        }
        ref: {
         appname: {
          part: "PetShopModel"
         }
         path: "Breed"
        }
       }
      }
     }
     attr_defs: {
      key: "pets"
      value: {
       set: {
        type_ref: {
         context: {
          appname: {
           part: "PetShopApiToModel"
          }
          path: "AnonType_0__"
         }
         ref: {
          appname: {
           part: "PetShopModel"
          }
          path: "Pet"
         }
        }
       }
      }
     }
    }
   }
  }
  views: {
   key: "apiToModel"
   value: {
    param: {
     name: "petshop"
     type: {
      type_ref: {
       ref: {
        appname: {
         part: "PetShopApi"
        }
        path: "PetShop"
       }
      }
     }
    }
    ret_type: {
     type_ref: {
      context: {
       appname: {
        part: "PetShopApiToModel"
       }
      }
      ref: {
       path: "PetShopModel"
      }
     }
    }
    expr: {
     transform: {
      arg: {
       name: "petshop"
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 125
         col: 8
        }
        end: {
         line: 125
         col: 15
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 125
         col: 8
        }
        end: {
         line: 125
         col: 15
        }
       }
      }
      scopevar: "."
      stmt: {
       let: {
        name: "_breedsAndPets"
        expr: {
         transform: {
          arg: {
           get_attr: {
            arg: {
             name: "."
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 126
               col: 33
              }
              end: {
               line: 126
               col: 40
              }
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 126
               col: 33
              }
              end: {
               line: 126
               col: 40
              }
             }
            }
            attr: "breeds"
           }
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 126
             col: 33
            }
            end: {
             line: 126
             col: 40
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 126
             col: 33
            }
            end: {
             line: 126
             col: 40
            }
           }
          }
          scopevar: "."
          stmt: {
           let: {
            name: "breedId"
            expr: {
             call: {
              func: "autoinc"
             }
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 127
               col: 16
              }
              end: {
               line: 127
               col: 39
              }
              text: "let breedId = autoinc()"
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 127
               col: 16
              }
              end: {
               line: 127
               col: 39
              }
              text: "let breedId = autoinc()"
             }
            }
           }
          }
          stmt: {
           assign: {
            name: "breed"
            expr: {
             transform: {
              arg: {
               name: "."
               source_context: {
                file: "tests/petshop.sysl"
                start: {
                 line: 129
                 col: 24
                }
                end: {
                 line: 133
                 col: 18
                }
               }
               source_contexts: {
                file: "tests/petshop.sysl"
                start: {
                 line: 129
                 col: 24
                }
                end: {
                 line: 133
                 col: 18
                }
               }
              }
              scopevar: "."
              stmt: {
               assign: {
                name: "breedId"
                expr: {
                 name: "breedId"
                 source_context: {
                  file: "tests/petshop.sysl"
                  start: {
                   line: 130
                   col: 20
                  }
                  end: {
                   line: 130
                   col: 37
                  }
                  text: "breedId = breedId"
                 }
                 source_contexts: {
                  file: "tests/petshop.sysl"
                  start: {
                   line: 130
                   col: 20
                  }
                  end: {
                   line: 130
                   col: 37
                  }
                  text: "breedId = breedId"
                 }
                }
               }
              }
              stmt: {
               assign: {
                name: "species"
                expr: {
                 get_attr: {
                  arg: {
                   name: "."
                   source_context: {
                    file: "tests/petshop.sysl"
                    start: {
                     line: 131
                     col: 30
                    }
                    end: {
                     line: 131
                     col: 38
                    }
                   }
                   source_contexts: {
                    file: "tests/petshop.sysl"
                    start: {
                     line: 131
                     col: 30
                    }
                    end: {
                     line: 131
                     col: 38
                    }
                   }
                  }
                  attr: "species"
                 }
                 source_context: {
                  file: "tests/petshop.sysl"
                  start: {
                   line: 131
                   col: 20
                  }
                  end: {
                   line: 131
                   col: 38
                  }
                  text: "species = .species"
                 }
                 source_contexts: {
                  file: "tests/petshop.sysl"
                  start: {
                   line: 131
                   col: 20
                  }
                  end: {
                   line: 131
                   col: 38
                  }
                  text: "species = .species"
                 }
                }
               }
              }
              stmt: {
               assign: {
                name: "breedName"
                expr: {
                 get_attr: {
                  arg: {
                   name: "."
                   source_context: {
                    file: "tests/petshop.sysl"
                    start: {
                     line: 132
                     col: 32
                    }
                    end: {
                     line: 132
                     col: 37
                    }
                   }
                   source_contexts: {
                    file: "tests/petshop.sysl"
                    start: {
                     line: 132
                     col: 32
                    }
                    end: {
                     line: 132
                     col: 37
                    }
                   }
                  }
                  attr: "name"
                 }
                 source_context: {
                  file: "tests/petshop.sysl"
                  start: {
                   line: 132
                   col: 20
                  }
                  end: {
                   line: 132
                   col: 37
                  }
                  text: "breedName = .name"
                 }
                 source_contexts: {
                  file: "tests/petshop.sysl"
                  start: {
                   line: 132
                   col: 20
                  }
                  end: {
                   line: 132
                   col: 37
                  }
                  text: "breedName = .name"
                 }
                }
               }
              }
             }
             type: {
              type_ref: {
               context: {
                appname: {
                 part: "PetShopApiToModel"
                }
               }
               ref: {
                appname: {
                 part: "PetShopModel"
                }
                path: "Breed"
               }
              }
             }
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 129
               col: 16
              }
              end: {
               line: 133
               col: 18
              }
              text: "breed = -> <PetShopModel.Breed>(:\n                    breedId = breedId\n                    species = .species\n                    breedName = .name\n                )\n"
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 129
               col: 16
              }
              end: {
               line: 133
               col: 18
              }
              text: "breed = -> <PetShopModel.Breed>(:\n                    breedId = breedId\n                    species = .species\n                    breedName = .name\n                )\n"
             }
            }
           }
          }
          stmt: {
           assign: {
            name: "pets"
            expr: {
             transform: {
              arg: {
               get_attr: {
                arg: {
                 name: "."
                 source_context: {
                  file: "tests/petshop.sysl"
                  start: {
                   line: 135
                   col: 23
                  }
                  end: {
                   line: 135
                   col: 28
                  }
                 }
                 source_contexts: {
                  file: "tests/petshop.sysl"
                  start: {
                   line: 135
                   col: 23
                  }
                  end: {
                   line: 135
                   col: 28
                  }
                 }
                }
                attr: "pets"
               }
               source_context: {
                file: "tests/petshop.sysl"
                start: {
                 line: 135
                 col: 23
                }
                end: {
                 line: 135
                 col: 28
                }
               }
               source_contexts: {
                file: "tests/petshop.sysl"
                start: {
                 line: 135
                 col: 23
                }
                end: {
                 line: 135
                 col: 28
                }
               }
              }
              scopevar: "."
              stmt: {
               assign: {
                name: "petId"
                expr: {
                 call: {
                  func: "autoinc"
                 }
                 source_context: {
                  file: "tests/petshop.sysl"
                  start: {
                   line: 136
                   col: 20
                  }
                  end: {
                   line: 136
                   col: 37
                  }
                  text: "petId = autoinc()"
                 }
                 source_contexts: {
                  file: "tests/petshop.sysl"
                  start: {
                   line: 136
                   col: 20
                  }
                  end: {
                   line: 136
                   col: 37
                  }
                  text: "petId = autoinc()"
                 }
                }
               }
              }
              stmt: {
               assign: {
                name: "breedId"
                expr: {
                 name: "breedId"
                 source_context: {
                  file: "tests/petshop.sysl"
                  start: {
                   line: 137
                   col: 20
                  }
                  end: {
                   line: 137
                   col: 37
                  }
                  text: "breedId = breedId"
                 }
                 source_contexts: {
                  file: "tests/petshop.sysl"
                  start: {
                   line: 137
                   col: 20
                  }
                  end: {
                   line: 137
                   col: 37
                  }
                  text: "breedId = breedId"
                 }
                }
               }
              }
              stmt: {
               assign: {
                name: "name"
                expr: {
                 get_attr: {
                  arg: {
                   name: "."
                   source_context: {
                    file: "tests/petshop.sysl"
                    start: {
                     line: 138
                     col: 20
                    }
                    end: {
                     line: 138
                     col: 26
                    }
                   }
                   source_contexts: {
                    file: "tests/petshop.sysl"
                    start: {
                     line: 138
                     col: 20
                    }
                    end: {
                     line: 138
                     col: 26
                    }
                   }
                  }
                  attr: "name"
                 }
                 source_context: {
                  file: "tests/petshop.sysl"
                  start: {
                   line: 138
                   col: 20
                  }
                  end: {
                   line: 138
                   col: 26
                  }
                 }
                 source_contexts: {
                  file: "tests/petshop.sysl"
                  start: {
                   line: 138
                   col: 20
                  }
                  end: {
                   line: 138
                   col: 26
                  }
                 }
                }
               }
              }
              stmt: {
               assign: {
                name: "dob"
                expr: {
                 get_attr: {
                  arg: {
                   name: "."
                   source_context: {
                    file: "tests/petshop.sysl"
                    start: {
                     line: 139
                     col: 20
                    }
                    end: {
                     line: 139
                     col: 25
                    }
                   }
                   source_contexts: {
                    file: "tests/petshop.sysl"
                    start: {
                     line: 139
                     col: 20
                    }
                    end: {
                     line: 139
                     col: 25
                    }
                   }
                  }
                  attr: "dob"
                 }
                 source_context: {
                  file: "tests/petshop.sysl"
                  start: {
                   line: 139
                   col: 20
                  }
                  end: {
                   line: 139
                   col: 25
                  }
                 }
                 source_contexts: {
                  file: "tests/petshop.sysl"
                  start: {
                   line: 139
                   col: 20
                  }
                  end: {
                   line: 139
                   col: 25
                  }
                 }
                }
               }
              }
             }
             type: {
              set: {
               type_ref: {
                context: {
                 appname: {
                  part: "PetShopApiToModel"
                 }
                }
                ref: {
                 appname: {
                  part: "PetShopModel"
                 }
                 path: "Pet"
                }
               }
              }
             }
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 135
               col: 16
              }
              end: {
               line: 140
               col: 18
              }
              text: "pets = .pets -> <set of PetShopModel.Pet>(:\n                    petId = autoinc()\n                    breedId = breedId\n                    .name\n                    .dob\n                )\n"
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 135
               col: 16
              }
              end: {
               line: 140
               col: 18
              }
              text: "pets = .pets -> <set of PetShopModel.Pet>(:\n                    petId = autoinc()\n                    breedId = breedId\n                    .name\n                    .dob\n                )\n"
             }
            }
           }
          }
         }
         type: {
          set: {
           type_ref: {
            context: {
             appname: {
              part: "PetShopApiToModel"
             }
            }
            ref: {
             appname: {
              part: "PetShopApiToModel"
             }
             path: "AnonType_0__"
            }
           }
          }
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 126
           col: 12
          }
          end: {
           line: 141
           col: 14
          }
          text: "let _breedsAndPets = .breeds -> <set of>(:\n                let breedId = autoinc()\n\n                breed = -> <PetShopModel.Breed>(:\n                    breedId = breedId\n                    species = .species\n                    breedName = .name\n                )\n\n                pets = .pets -> <set of PetShopModel.Pet>(:\n                    petId = autoinc()\n                    breedId = breedId\n                    .name\n                    .dob\n                )\n            )\n"
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 126
           col: 12
          }
          end: {
           line: 141
           col: 14
          }
          text: "let _breedsAndPets = .breeds -> <set of>(:\n                let breedId = autoinc()\n\n                breed = -> <PetShopModel.Breed>(:\n                    breedId = breedId\n                    species = .species\n                    breedName = .name\n                )\n\n                pets = .pets -> <set of PetShopModel.Pet>(:\n                    petId = autoinc()\n                    breedId = breedId\n                    .name\n                    .dob\n                )\n            )\n"
         }
        }
       }
      }
      stmt: {
       let: {
        name: "breedsAndPets"
        expr: {
         relexpr: {
          op: SNAPSHOT
          target: {
           name: "_breedsAndPets"
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 143
             col: 32
            }
            end: {
             line: 143
             col: 46
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 143
             col: 32
            }
            end: {
             line: 143
             col: 46
            }
           }
          }
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 143
           col: 12
          }
          end: {
           line: 143
           col: 55
          }
          text: "let breedsAndPets = _breedsAndPets snapshot"
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 143
           col: 12
          }
          end: {
           line: 143
           col: 55
          }
          text: "let breedsAndPets = _breedsAndPets snapshot"
         }
        }
       }
      }
      stmt: {
       let: {
        name: "minId1"
        expr: {
         relexpr: {
          op: MAX
          target: {
           name: "breedsAndPets"
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 145
             col: 25
            }
            end: {
             line: 145
             col: 38
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 145
             col: 25
            }
            end: {
             line: 145
             col: 38
            }
           }
          }
          arg: {
           get_attr: {
            arg: {
             get_attr: {
              arg: {
               name: "."
               source_context: {
                file: "tests/petshop.sysl"
                start: {
                 line: 145
                 col: 43
                }
                end: {
                 line: 145
                 col: 49
                }
               }
               source_contexts: {
                file: "tests/petshop.sysl"
                start: {
                 line: 145
                 col: 43
                }
                end: {
                 line: 145
                 col: 49
                }
               }
              }
              attr: "breed"
             }
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 145
               col: 43
              }
              end: {
               line: 145
               col: 49
              }
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 145
               col: 43
              }
              end: {
               line: 145
               col: 49
              }
             }
            }
            attr: "breedId"
           }
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 145
             col: 49
            }
            end: {
             line: 145
             col: 57
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 145
             col: 49
            }
            end: {
             line: 145
             col: 57
            }
           }
          }
          scopevar: "."
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 145
           col: 12
          }
          end: {
           line: 145
           col: 58
          }
          text: "let minId1 = breedsAndPets max(.breed.breedId)"
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 145
           col: 12
          }
          end: {
           line: 145
           col: 58
          }
          text: "let minId1 = breedsAndPets max(.breed.breedId)"
         }
        }
       }
      }
      stmt: {
       let: {
        name: "minId2"
        expr: {
         relexpr: {
          op: MAX
          target: {
           name: "breedsAndPets"
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 146
             col: 25
            }
            end: {
             line: 146
             col: 38
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 146
             col: 25
            }
            end: {
             line: 146
             col: 38
            }
           }
          }
          arg: {
           get_attr: {
            arg: {
             get_attr: {
              arg: {
               name: "."
               source_context: {
                file: "tests/petshop.sysl"
                start: {
                 line: 146
                 col: 43
                }
                end: {
                 line: 146
                 col: 49
                }
               }
               source_contexts: {
                file: "tests/petshop.sysl"
                start: {
                 line: 146
                 col: 43
                }
                end: {
                 line: 146
                 col: 49
                }
               }
              }
              attr: "breed"
             }
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 146
               col: 43
              }
              end: {
               line: 146
               col: 49
              }
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 146
               col: 43
              }
              end: {
               line: 146
               col: 49
              }
             }
            }
            attr: "breedId"
           }
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 146
             col: 49
            }
            end: {
             line: 146
             col: 57
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 146
             col: 49
            }
            end: {
             line: 146
             col: 57
            }
           }
          }
          scopevar: "."
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 146
           col: 12
          }
          end: {
           line: 146
           col: 58
          }
          text: "let minId2 = breedsAndPets max(.breed.breedId)"
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 146
           col: 12
          }
          end: {
           line: 146
           col: 58
          }
          text: "let minId2 = breedsAndPets max(.breed.breedId)"
         }
        }
       }
      }
      stmt: {
       let: {
        name: "lee"
        expr: {
         transform: {
          arg: {
           set: {
            expr: {
             tuple: {}
             type: {
              tuple: {}
             }
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 148
               col: 23
              }
              end: {
               line: 148
               col: 26
              }
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 148
               col: 23
              }
              end: {
               line: 148
               col: 26
              }
             }
            }
           }
           type: {
            set: {
             tuple: {}
            }
           }
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 148
             col: 22
            }
            end: {
             line: 148
             col: 27
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 148
             col: 22
            }
            end: {
             line: 148
             col: 27
            }
           }
          }
          scopevar: "."
          stmt: {
           assign: {
            name: "name"
            expr: {
             literal: {
              s: "Bruce"
             }
             type: {
              primitive: STRING
             }
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 149
               col: 16
              }
              end: {
               line: 149
               col: 30
              }
              text: "name = \"Bruce\""
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 149
               col: 16
              }
              end: {
               line: 149
               col: 30
              }
              text: "name = \"Bruce\""
             }
            }
           }
          }
         }
         type: {
          set: {
           type_ref: {
            context: {
             appname: {
              part: "PetShopApiToModel"
             }
            }
            ref: {
             appname: {
              part: "PetShopModel"
             }
             path: "Employee"
            }
           }
          }
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 148
           col: 12
          }
          end: {
           line: 150
           col: 14
          }
          text: "let lee = {{:}} -> <set of PetShopModel.Employee>(:\n                name = \"Bruce\"\n            )\n"
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 148
           col: 12
          }
          end: {
           line: 150
           col: 14
          }
          text: "let lee = {{:}} -> <set of PetShopModel.Employee>(:\n                name = \"Bruce\"\n            )\n"
         }
        }
       }
      }
      stmt: {
       let: {
        name: "leeless"
        expr: {
         unexpr: {
          op: NOT
          arg: {
           name: "lee"
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 152
             col: 27
            }
            end: {
             line: 152
             col: 30
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 152
             col: 27
            }
            end: {
             line: 152
             col: 30
            }
           }
          }
         }
         type: {
          primitive: BOOL
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 152
           col: 12
          }
          end: {
           line: 152
           col: 30
          }
          text: "let leeless = !lee"
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 152
           col: 12
          }
          end: {
           line: 152
           col: 30
          }
          text: "let leeless = !lee"
         }
        }
       }
      }
      stmt: {
       let: {
        name: "decimal1"
        expr: {
         literal: {
          decimal: "1.2"
         }
         type: {
          primitive: DECIMAL
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 154
           col: 12
          }
          end: {
           line: 154
           col: 30
          }
          text: "let decimal1 = 1.2"
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 154
           col: 12
          }
          end: {
           line: 154
           col: 30
          }
          text: "let decimal1 = 1.2"
         }
        }
       }
      }
      stmt: {
       let: {
        name: "decimal2"
        expr: {
         literal: {
          decimal: "2.3"
         }
         type: {
          primitive: DECIMAL
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 155
           col: 12
          }
          end: {
           line: 155
           col: 30
          }
          text: "let decimal2 = 2.3"
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 155
           col: 12
          }
          end: {
           line: 155
           col: 30
          }
          text: "let decimal2 = 2.3"
         }
        }
       }
      }
      stmt: {
       let: {
        name: "decimal3"
        expr: {
         binexpr: {
          op: ADD
          lhs: {
           unexpr: {
            op: POS
            arg: {
             name: "decimal1"
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 156
               col: 28
              }
              end: {
               line: 156
               col: 36
              }
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 156
               col: 28
              }
              end: {
               line: 156
               col: 36
              }
             }
            }
           }
           type: {
            primitive: INT
           }
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 156
             col: 27
            }
            end: {
             line: 156
             col: 36
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 156
             col: 27
            }
            end: {
             line: 156
             col: 36
            }
           }
          }
          rhs: {
           name: "decimal2"
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 156
             col: 39
            }
            end: {
             line: 156
             col: 47
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 156
             col: 39
            }
            end: {
             line: 156
             col: 47
            }
           }
          }
         }
         type: {
          no_type: {}
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 156
           col: 12
          }
          end: {
           line: 156
           col: 47
          }
          text: "let decimal3 = +decimal1 + decimal2"
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 156
           col: 12
          }
          end: {
           line: 156
           col: 47
          }
          text: "let decimal3 = +decimal1 + decimal2"
         }
        }
       }
      }
      stmt: {
       let: {
        name: "one_third"
        expr: {
         binexpr: {
          op: DIV
          lhs: {
           literal: {
            decimal: "1.0"
           }
           type: {
            primitive: DECIMAL
           }
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 158
             col: 28
            }
            end: {
             line: 158
             col: 31
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 158
             col: 28
            }
            end: {
             line: 158
             col: 31
            }
           }
          }
          rhs: {
           literal: {
            decimal: "3.0"
           }
           type: {
            primitive: DECIMAL
           }
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 158
             col: 34
            }
            end: {
             line: 158
             col: 37
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 158
             col: 34
            }
            end: {
             line: 158
             col: 37
            }
           }
          }
         }
         type: {
          primitive: DECIMAL
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 158
           col: 12
          }
          end: {
           line: 158
           col: 37
          }
          text: "let one_third = 1.0 / 3.0"
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 158
           col: 12
          }
          end: {
           line: 158
           col: 37
          }
          text: "let one_third = 1.0 / 3.0"
         }
        }
       }
      }
      stmt: {
       let: {
        name: "one_ninth"
        expr: {
         binexpr: {
          op: POW
          lhs: {
           name: "one_third"
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 159
             col: 28
            }
            end: {
             line: 159
             col: 37
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 159
             col: 28
            }
            end: {
             line: 159
             col: 37
            }
           }
          }
          rhs: {
           literal: {
            i: 2
           }
           type: {
            primitive: INT
           }
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 159
             col: 41
            }
            end: {
             line: 159
             col: 42
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 159
             col: 41
            }
            end: {
             line: 159
             col: 42
            }
           }
          }
         }
         type: {
          primitive: INT
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 159
           col: 12
          }
          end: {
           line: 159
           col: 42
          }
          text: "let one_ninth = one_third ** 2"
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 159
           col: 12
          }
          end: {
           line: 159
           col: 42
          }
          text: "let one_ninth = one_third ** 2"
         }
        }
       }
      }
      stmt: {
       let: {
        name: "bruce_lee"
        expr: {
         binexpr: {
          op: ADD
          lhs: {
           get_attr: {
            arg: {
             unexpr: {
              op: SINGLE_OR_NULL
              arg: {
               name: "lee"
               source_context: {
                file: "tests/petshop.sysl"
                start: {
                 line: 163
                 col: 28
                }
                end: {
                 line: 163
                 col: 31
                }
               }
               source_contexts: {
                file: "tests/petshop.sysl"
                start: {
                 line: 163
                 col: 28
                }
                end: {
                 line: 163
                 col: 31
                }
               }
              }
             }
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 163
               col: 32
              }
              end: {
               line: 163
               col: 44
              }
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 163
               col: 32
              }
              end: {
               line: 163
               col: 44
              }
             }
            }
            attr: "name"
            nullsafe: true
           }
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 163
             col: 44
            }
            end: {
             line: 163
             col: 50
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 163
             col: 44
            }
            end: {
             line: 163
             col: 50
            }
           }
          }
          rhs: {
           call: {
            func: "substr"
            arg: {
             literal: {
              s: " Leek"
             }
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 163
               col: 60
              }
              end: {
               line: 163
               col: 67
              }
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 163
               col: 60
              }
              end: {
               line: 163
               col: 67
              }
             }
            }
            arg: {
             literal: {
              i: 0
             }
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 163
               col: 69
              }
              end: {
               line: 163
               col: 70
              }
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 163
               col: 69
              }
              end: {
               line: 163
               col: 70
              }
             }
            }
            arg: {
             literal: {
              i: 4
             }
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 163
               col: 72
              }
              end: {
               line: 163
               col: 73
              }
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 163
               col: 72
              }
              end: {
               line: 163
               col: 73
              }
             }
            }
           }
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 163
             col: 53
            }
            end: {
             line: 163
             col: 74
            }
            text: "substr(\" Leek\", 0, 4)"
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 163
             col: 53
            }
            end: {
             line: 163
             col: 74
            }
            text: "substr(\" Leek\", 0, 4)"
           }
          }
         }
         type: {
          no_type: {}
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 163
           col: 12
          }
          end: {
           line: 163
           col: 74
          }
          text: "let bruce_lee = lee singleOrNull?.name + substr(\" Leek\", 0, 4)"
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 163
           col: 12
          }
          end: {
           line: 163
           col: 74
          }
          text: "let bruce_lee = lee singleOrNull?.name + substr(\" Leek\", 0, 4)"
         }
        }
       }
      }
      stmt: {
       assign: {
        name: "Employee"
        expr: {
         transform: {
          arg: {
           get_attr: {
            arg: {
             name: "."
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 165
               col: 32
              }
              end: {
               line: 165
               col: 42
              }
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 165
               col: 32
              }
              end: {
               line: 165
               col: 42
              }
             }
            }
            attr: "employees"
           }
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 165
             col: 32
            }
            end: {
             line: 165
             col: 42
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 165
             col: 32
            }
            end: {
             line: 165
             col: 42
            }
           }
          }
          scopevar: "."
          stmt: {
           assign: {
            name: "employeeId"
            expr: {
             call: {
              func: "autoinc"
             }
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 166
               col: 16
              }
              end: {
               line: 166
               col: 38
              }
              text: "employeeId = autoinc()"
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 166
               col: 16
              }
              end: {
               line: 166
               col: 38
              }
              text: "employeeId = autoinc()"
             }
            }
           }
          }
          stmt: {
           assign: {
            name: "name"
            expr: {
             get_attr: {
              arg: {
               name: "."
               source_context: {
                file: "tests/petshop.sysl"
                start: {
                 line: 167
                 col: 16
                }
                end: {
                 line: 167
                 col: 22
                }
               }
               source_contexts: {
                file: "tests/petshop.sysl"
                start: {
                 line: 167
                 col: 16
                }
                end: {
                 line: 167
                 col: 22
                }
               }
              }
              attr: "name"
             }
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 167
               col: 16
              }
              end: {
               line: 167
               col: 22
              }
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 167
               col: 16
              }
              end: {
               line: 167
               col: 22
              }
             }
            }
           }
          }
          stmt: {
           assign: {
            name: "dob"
            expr: {
             get_attr: {
              arg: {
               name: "."
               source_context: {
                file: "tests/petshop.sysl"
                start: {
                 line: 168
                 col: 16
                }
                end: {
                 line: 168
                 col: 21
                }
               }
               source_contexts: {
                file: "tests/petshop.sysl"
                start: {
                 line: 168
                 col: 16
                }
                end: {
                 line: 168
                 col: 21
                }
               }
              }
              attr: "dob"
             }
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 168
               col: 16
              }
              end: {
               line: 168
               col: 21
              }
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 168
               col: 16
              }
              end: {
               line: 168
               col: 21
              }
             }
            }
           }
          }
          stmt: {
           assign: {
            name: "error"
            expr: {
             binexpr: {
              op: SUB
              lhs: {
               name: "minId2"
               source_context: {
                file: "tests/petshop.sysl"
                start: {
                 line: 169
                 col: 24
                }
                end: {
                 line: 169
                 col: 30
                }
               }
               source_contexts: {
                file: "tests/petshop.sysl"
                start: {
                 line: 169
                 col: 24
                }
                end: {
                 line: 169
                 col: 30
                }
               }
              }
              rhs: {
               name: "minId1"
               source_context: {
                file: "tests/petshop.sysl"
                start: {
                 line: 169
                 col: 33
                }
                end: {
                 line: 169
                 col: 39
                }
               }
               source_contexts: {
                file: "tests/petshop.sysl"
                start: {
                 line: 169
                 col: 33
                }
                end: {
                 line: 169
                 col: 39
                }
               }
              }
             }
             type: {
              no_type: {}
             }
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 169
               col: 16
              }
              end: {
               line: 169
               col: 39
              }
              text: "error = minId2 - minId1"
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 169
               col: 16
              }
              end: {
               line: 169
               col: 39
              }
              text: "error = minId2 - minId1"
             }
            }
           }
          }
         }
         type: {
          set: {
           type_ref: {
            context: {
             appname: {
              part: "PetShopApiToModel"
             }
            }
            ref: {
             appname: {
              part: "PetShopModel"
             }
             path: "Employee"
            }
           }
          }
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 165
           col: 32
          }
          end: {
           line: 170
           col: 14
          }
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 165
           col: 32
          }
          end: {
           line: 170
           col: 14
          }
         }
        }
        table: true
       }
      }
      stmt: {
       assign: {
        name: "Breed"
        expr: {
         navigate: {
          arg: {
           name: "breedsAndPets"
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 171
             col: 29
            }
            end: {
             line: 171
             col: 42
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 171
             col: 29
            }
            end: {
             line: 171
             col: 42
            }
           }
          }
          attr: ".breed"
          setof: true
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 171
           col: 43
          }
          end: {
           line: 171
           col: 59
          }
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 171
           col: 43
          }
          end: {
           line: 171
           col: 59
          }
         }
        }
        table: true
       }
      }
      stmt: {
       assign: {
        name: "Pet"
        expr: {
         binexpr: {
          op: FLATTEN
          lhs: {
           name: "breedsAndPets"
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 172
             col: 27
            }
            end: {
             line: 172
             col: 40
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 172
             col: 27
            }
            end: {
             line: 172
             col: 40
            }
           }
          }
          rhs: {
           get_attr: {
            arg: {
             name: "."
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 172
               col: 49
              }
              end: {
               line: 172
               col: 54
              }
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 172
               col: 49
              }
              end: {
               line: 172
               col: 54
              }
             }
            }
            attr: "pets"
           }
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 172
             col: 49
            }
            end: {
             line: 172
             col: 54
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 172
             col: 49
            }
            end: {
             line: 172
             col: 54
            }
           }
          }
          scopevar: "."
         }
         type: {
          no_type: {}
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 172
           col: 41
          }
          end: {
           line: 172
           col: 48
          }
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 172
           col: 41
          }
          end: {
           line: 172
           col: 48
          }
         }
        }
        table: true
       }
      }
     }
     type: {
      type_ref: {
       context: {
        appname: {
         part: "PetShopApiToModel"
        }
       }
       ref: {
        path: "PetShopModel"
       }
      }
     }
     source_context: {
      file: "tests/petshop.sysl"
      start: {
       line: 125
       col: 8
      }
      end: {
       line: 173
       col: 10
      }
     }
     source_contexts: {
      file: "tests/petshop.sysl"
      start: {
       line: 125
       col: 8
      }
      end: {
       line: 173
       col: 10
      }
     }
    }
    source_context: {
     file: "tests/petshop.sysl"
     start: {
      line: 124
      col: 4
     }
     end: {
      line: 174
      col: 1
     }
     text: "!view apiToModel(petshop <: PetShopApi.PetShop):"
    }
    source_contexts: {
     file: "tests/petshop.sysl"
     start: {
      line: 124
      col: 4
     }
     end: {
      line: 174
      col: 1
     }
     text: "!view apiToModel(petshop <: PetShopApi.PetShop):"
    }
   }
  }
  source_context: {
   file: "tests/petshop.sysl"
   start: {
    line: 123
   }
   end: {
    line: 172
    col: 54
   }
  }
  source_contexts: {
   file: "tests/petshop.sysl"
   start: {
    line: 123
   }
   end: {
    line: 172
    col: 54
   }
  }
 }
}
apps: {
 key: "PetShopFacade"
 value: {
  name: {
   part: "PetShopFacade"
  }
  attrs: {
   key: "package"
   value: {
    s: "io.sysl.demo.petshop.facade"
    source_context: {
     file: "tests/petshop.sysl"
     start: {
      line: 28
      col: 15
     }
     end: {
      line: 28
      col: 52
     }
    }
    source_contexts: {
     file: "tests/petshop.sysl"
     start: {
      line: 28
      col: 15
     }
     end: {
      line: 28
      col: 52
     }
    }
   }
  }
  wrapped: {
   name: {
    part: "PetShopModel"
   }
   types: {
    key: "Breed"
    value: {}
   }
   types: {
    key: "Employee"
    value: {}
   }
   types: {
    key: "EmployeeTendsPet"
    value: {}
   }
   types: {
    key: "Pet"
    value: {}
   }
  }
  source_context: {
   file: "tests/petshop.sysl"
   start: {
    line: 28
   }
   end: {
    line: 28
    col: 53
   }
  }
  source_contexts: {
   file: "tests/petshop.sysl"
   start: {
    line: 28
   }
   end: {
    line: 28
    col: 53
   }
  }
 }
}
apps: {
 key: "PetShopModel"
 value: {
  name: {
   part: "PetShopModel"
  }
  attrs: {
   key: "package"
   value: {
    s: "io.sysl.demo.petshop.model"
    source_context: {
     file: "tests/petshop.sysl"
     start: {
      col: 14
     }
     end: {
      col: 50
     }
    }
    source_contexts: {
     file: "tests/petshop.sysl"
     start: {
      col: 14
     }
     end: {
      col: 50
     }
    }
   }
  }
  types: {
   key: "Breed"
   value: {
    relation: {
     attr_defs: {
      key: "avgLifespan"
      value: {
       primitive: DECIMAL
       constraint: {
        length: {
         max: 14
        }
        precision: 14
        scale: 2
       }
       opt: true
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 12
         col: 8
        }
        end: {
         line: 12
         col: 37
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 12
         col: 8
        }
        end: {
         line: 12
         col: 37
        }
       }
      }
     }
     attr_defs: {
      key: "avgWeight"
      value: {
       primitive: DECIMAL
       constraint: {
        length: {
         max: 14
        }
       }
       opt: true
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 13
         col: 8
        }
        end: {
         line: 13
         col: 33
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 13
         col: 8
        }
        end: {
         line: 13
         col: 33
        }
       }
      }
     }
     attr_defs: {
      key: "breedId"
      value: {
       primitive: INT
       attrs: {
        key: "patterns"
        value: {
         a: {
          elt: {
           s: "pk"
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 8
             col: 24
            }
            end: {
             line: 8
             col: 27
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 8
             col: 24
            }
            end: {
             line: 8
             col: 27
            }
           }
          }
          elt: {
           s: "autoinc"
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 8
             col: 29
            }
            end: {
             line: 8
             col: 37
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 8
             col: 29
            }
            end: {
             line: 8
             col: 37
            }
           }
          }
         }
        }
       }
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 8
         col: 8
        }
        end: {
         line: 8
         col: 38
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 8
         col: 8
        }
        end: {
         line: 8
         col: 38
        }
       }
      }
     }
     attr_defs: {
      key: "breedName"
      value: {
       primitive: STRING
       opt: true
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 9
         col: 8
        }
        end: {
         line: 9
         col: 28
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 9
         col: 8
        }
        end: {
         line: 9
         col: 28
        }
       }
      }
     }
     attr_defs: {
      key: "legRank"
      value: {
       primitive: INT
       opt: true
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 14
         col: 8
        }
        end: {
         line: 14
         col: 23
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 14
         col: 8
        }
        end: {
         line: 14
         col: 23
        }
       }
      }
     }
     attr_defs: {
      key: "numLegs"
      value: {
       primitive: INT
       opt: true
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 11
         col: 8
        }
        end: {
         line: 11
         col: 23
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 11
         col: 8
        }
        end: {
         line: 11
         col: 23
        }
       }
      }
     }
     attr_defs: {
      key: "species"
      value: {
       primitive: STRING
       opt: true
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 10
         col: 8
        }
        end: {
         line: 10
         col: 26
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 10
         col: 8
        }
        end: {
         line: 10
         col: 26
        }
       }
      }
     }
     primary_key: {
      attr_name: "breedId"
     }
    }
    source_context: {
     file: "tests/petshop.sysl"
     start: {
      line: 7
      col: 4
     }
     end: {
      line: 14
      col: 23
     }
    }
    source_contexts: {
     file: "tests/petshop.sysl"
     start: {
      line: 7
      col: 4
     }
     end: {
      line: 14
      col: 23
     }
    }
   }
  }
  types: {
   key: "Employee"
   value: {
    relation: {
     attr_defs: {
      key: "dob"
      value: {
       primitive: DATE
       opt: true
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 4
         col: 8
        }
        end: {
         line: 4
         col: 20
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 4
         col: 8
        }
        end: {
         line: 4
         col: 20
        }
       }
      }
     }
     attr_defs: {
      key: "employeeId"
      value: {
       primitive: INT
       attrs: {
        key: "patterns"
        value: {
         a: {
          elt: {
           s: "pk"
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 2
             col: 27
            }
            end: {
             line: 2
             col: 30
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 2
             col: 27
            }
            end: {
             line: 2
             col: 30
            }
           }
          }
          elt: {
           s: "autoinc"
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 2
             col: 32
            }
            end: {
             line: 2
             col: 40
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 2
             col: 32
            }
            end: {
             line: 2
             col: 40
            }
           }
          }
         }
        }
       }
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 2
         col: 8
        }
        end: {
         line: 2
         col: 41
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 2
         col: 8
        }
        end: {
         line: 2
         col: 41
        }
       }
      }
     }
     attr_defs: {
      key: "error"
      value: {
       primitive: INT
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 5
         col: 8
        }
        end: {
         line: 5
         col: 20
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 5
         col: 8
        }
        end: {
         line: 5
         col: 20
        }
       }
      }
     }
     attr_defs: {
      key: "name"
      value: {
       primitive: STRING
       opt: true
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 3
         col: 8
        }
        end: {
         line: 3
         col: 23
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 3
         col: 8
        }
        end: {
         line: 3
         col: 23
        }
       }
      }
     }
     primary_key: {
      attr_name: "employeeId"
     }
    }
    source_context: {
     file: "tests/petshop.sysl"
     start: {
      line: 1
      col: 4
     }
     end: {
      line: 5
      col: 20
     }
    }
    source_contexts: {
     file: "tests/petshop.sysl"
     start: {
      line: 1
      col: 4
     }
     end: {
      line: 5
      col: 20
     }
    }
   }
  }
  types: {
   key: "EmployeeTendsPet"
   value: {
    relation: {
     attr_defs: {
      key: "employeeId"
      value: {
       type_ref: {
        context: {
         appname: {
          part: "PetShopModel"
         }
         path: "EmployeeTendsPet"
        }
        ref: {
         path: "Employee"
         path: "employeeId"
        }
       }
       attrs: {
        key: "patterns"
        value: {
         a: {
          elt: {
           s: "pk"
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 24
             col: 43
            }
            end: {
             line: 24
             col: 46
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 24
             col: 43
            }
            end: {
             line: 24
             col: 46
            }
           }
          }
         }
        }
       }
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 24
         col: 8
        }
        end: {
         line: 24
         col: 47
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 24
         col: 8
        }
        end: {
         line: 24
         col: 47
        }
       }
      }
     }
     attr_defs: {
      key: "petId"
      value: {
       type_ref: {
        context: {
         appname: {
          part: "PetShopModel"
         }
         path: "EmployeeTendsPet"
        }
        ref: {
         path: "Pet"
         path: "petId"
        }
       }
       attrs: {
        key: "patterns"
        value: {
         a: {
          elt: {
           s: "pk"
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 25
             col: 28
            }
            end: {
             line: 25
             col: 31
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 25
             col: 28
            }
            end: {
             line: 25
             col: 31
            }
           }
          }
         }
        }
       }
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 25
         col: 8
        }
        end: {
         line: 25
         col: 32
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 25
         col: 8
        }
        end: {
         line: 25
         col: 32
        }
       }
      }
     }
     primary_key: {
      attr_name: "employeeId"
      attr_name: "petId"
     }
    }
    source_context: {
     file: "tests/petshop.sysl"
     start: {
      line: 23
      col: 4
     }
     end: {
      line: 25
      col: 31
     }
    }
    source_contexts: {
     file: "tests/petshop.sysl"
     start: {
      line: 23
      col: 4
     }
     end: {
      line: 25
      col: 31
     }
    }
   }
  }
  types: {
   key: "Pet"
   value: {
    relation: {
     attr_defs: {
      key: "breedId"
      value: {
       type_ref: {
        context: {
         appname: {
          part: "PetShopModel"
         }
         path: "Pet"
        }
        ref: {
         path: "Breed"
         path: "breedId"
        }
       }
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 18
         col: 8
        }
        end: {
         line: 18
         col: 32
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 18
         col: 8
        }
        end: {
         line: 18
         col: 32
        }
       }
      }
     }
     attr_defs: {
      key: "dob"
      value: {
       primitive: DATE
       opt: true
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 20
         col: 8
        }
        end: {
         line: 20
         col: 20
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 20
         col: 8
        }
        end: {
         line: 20
         col: 20
        }
       }
      }
     }
     attr_defs: {
      key: "name"
      value: {
       primitive: STRING
       opt: true
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 19
         col: 8
        }
        end: {
         line: 19
         col: 23
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 19
         col: 8
        }
        end: {
         line: 19
         col: 23
        }
       }
      }
     }
     attr_defs: {
      key: "numLegs"
      value: {
       primitive: INT
       opt: true
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 21
         col: 8
        }
        end: {
         line: 21
         col: 23
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 21
         col: 8
        }
        end: {
         line: 21
         col: 23
        }
       }
      }
     }
     attr_defs: {
      key: "petId"
      value: {
       primitive: INT
       attrs: {
        key: "patterns"
        value: {
         a: {
          elt: {
           s: "pk"
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 17
             col: 22
            }
            end: {
             line: 17
             col: 25
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 17
             col: 22
            }
            end: {
             line: 17
             col: 25
            }
           }
          }
          elt: {
           s: "autoinc"
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 17
             col: 27
            }
            end: {
             line: 17
             col: 35
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 17
             col: 27
            }
            end: {
             line: 17
             col: 35
            }
           }
          }
         }
        }
       }
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 17
         col: 8
        }
        end: {
         line: 17
         col: 36
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 17
         col: 8
        }
        end: {
         line: 17
         col: 36
        }
       }
      }
     }
     primary_key: {
      attr_name: "petId"
     }
    }
    source_context: {
     file: "tests/petshop.sysl"
     start: {
      line: 16
      col: 4
     }
     end: {
      line: 21
      col: 23
     }
    }
    source_contexts: {
     file: "tests/petshop.sysl"
     start: {
      line: 16
      col: 4
     }
     end: {
      line: 21
      col: 23
     }
    }
   }
  }
  source_context: {
   file: "tests/petshop.sysl"
   start: {}
   end: {
    line: 25
    col: 31
   }
  }
  source_contexts: {
   file: "tests/petshop.sysl"
   start: {}
   end: {
    line: 25
    col: 31
   }
  }
 }
}
apps: {
 key: "PetShopModelToApi"
 value: {
  name: {
   part: "PetShopModelToApi"
  }
  attrs: {
   key: "package"
   value: {
    s: "io.sysl.demo.petshop.views"
    source_context: {
     file: "tests/petshop.sysl"
     start: {
      line: 65
      col: 19
     }
     end: {
      line: 65
      col: 55
     }
    }
    source_contexts: {
     file: "tests/petshop.sysl"
     start: {
      line: 65
      col: 19
     }
     end: {
      line: 65
      col: 55
     }
    }
   }
  }
  types: {
   key: "PetRankedByLeg"
   value: {
    tuple: {
     attr_defs: {
      key: "breedId"
      value: {
       primitive: INT
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 116
         col: 8
        }
        end: {
         line: 116
         col: 22
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 116
         col: 8
        }
        end: {
         line: 116
         col: 22
        }
       }
      }
     }
     attr_defs: {
      key: "dob"
      value: {
       primitive: DATE
       opt: true
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 118
         col: 8
        }
        end: {
         line: 118
         col: 20
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 118
         col: 8
        }
        end: {
         line: 118
         col: 20
        }
       }
      }
     }
     attr_defs: {
      key: "legRank"
      value: {
       primitive: INT
       opt: true
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 120
         col: 8
        }
        end: {
         line: 120
         col: 23
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 120
         col: 8
        }
        end: {
         line: 120
         col: 23
        }
       }
      }
     }
     attr_defs: {
      key: "name"
      value: {
       primitive: STRING
       opt: true
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 117
         col: 8
        }
        end: {
         line: 117
         col: 23
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 117
         col: 8
        }
        end: {
         line: 117
         col: 23
        }
       }
      }
     }
     attr_defs: {
      key: "numLegs"
      value: {
       primitive: INT
       opt: true
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 119
         col: 8
        }
        end: {
         line: 119
         col: 23
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 119
         col: 8
        }
        end: {
         line: 119
         col: 23
        }
       }
      }
     }
     attr_defs: {
      key: "petId"
      value: {
       primitive: INT
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 115
         col: 8
        }
        end: {
         line: 115
         col: 20
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 115
         col: 8
        }
        end: {
         line: 115
         col: 20
        }
       }
      }
     }
    }
    source_context: {
     file: "tests/petshop.sysl"
     start: {
      line: 114
      col: 4
     }
     end: {
      line: 120
      col: 23
     }
    }
    source_contexts: {
     file: "tests/petshop.sysl"
     start: {
      line: 114
      col: 4
     }
     end: {
      line: 120
      col: 23
     }
    }
   }
  }
  views: {
   key: "breedToApi"
   value: {
    param: {
     name: "breed"
     type: {
      set: {
       type_ref: {
        ref: {
         appname: {
          part: "PetShopModel"
         }
         path: "Breed"
        }
       }
      }
     }
    }
    param: {
     name: "pet"
     type: {
      set: {
       type_ref: {
        ref: {
         appname: {
          part: "PetShopModelToApi"
         }
         path: "PetRankedByLeg"
        }
       }
      }
     }
    }
    ret_type: {
     set: {
      type_ref: {
       context: {
        appname: {
         part: "PetShopModelToApi"
        }
       }
       ref: {
        appname: {
         part: "PetShopApi"
        }
        path: "Breed"
       }
      }
     }
    }
    expr: {
     transform: {
      arg: {
       name: "breed"
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 96
         col: 8
        }
        end: {
         line: 96
         col: 13
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 96
         col: 8
        }
        end: {
         line: 96
         col: 13
        }
       }
      }
      scopevar: "."
      stmt: {
       assign: {
        name: "name"
        expr: {
         get_attr: {
          arg: {
           name: "."
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 97
             col: 19
            }
            end: {
             line: 97
             col: 29
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 97
             col: 19
            }
            end: {
             line: 97
             col: 29
            }
           }
          }
          attr: "breedName"
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 97
           col: 12
          }
          end: {
           line: 97
           col: 29
          }
          text: "name = .breedName"
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 97
           col: 12
          }
          end: {
           line: 97
           col: 29
          }
          text: "name = .breedName"
         }
        }
       }
      }
      stmt: {
       assign: {
        name: "species"
        expr: {
         get_attr: {
          arg: {
           name: "."
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 98
             col: 12
            }
            end: {
             line: 98
             col: 21
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 98
             col: 12
            }
            end: {
             line: 98
             col: 21
            }
           }
          }
          attr: "species"
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 98
           col: 12
          }
          end: {
           line: 98
           col: 21
          }
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 98
           col: 12
          }
          end: {
           line: 98
           col: 21
          }
         }
        }
       }
      }
      stmt: {
       assign: {
        name: "pets"
        expr: {
         call: {
          func: "petToApi"
          arg: {
           binexpr: {
            op: TO_MATCHING
            lhs: {
             navigate: {
              arg: {
               name: "."
               source_context: {
                file: "tests/petshop.sysl"
                start: {
                 line: 99
                 col: 28
                }
                end: {
                 line: 99
                 col: 41
                }
               }
               source_contexts: {
                file: "tests/petshop.sysl"
                start: {
                 line: 99
                 col: 28
                }
                end: {
                 line: 99
                 col: 41
                }
               }
              }
              attr: "Pet"
              setof: true
             }
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 99
               col: 28
              }
              end: {
               line: 99
               col: 41
              }
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 99
               col: 28
              }
              end: {
               line: 99
               col: 41
              }
             }
            }
            rhs: {
             name: "pet"
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 99
               col: 52
              }
              end: {
               line: 99
               col: 55
              }
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 99
               col: 52
              }
              end: {
               line: 99
               col: 55
              }
             }
            }
            attr_name: "petId"
           }
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 99
             col: 42
            }
            end: {
             line: 99
             col: 55
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 99
             col: 42
            }
            end: {
             line: 99
             col: 55
            }
           }
          }
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 99
           col: 12
          }
          end: {
           line: 99
           col: 56
          }
          text: "pets = petToApi(-> set of Pet ~[petId]> pet)"
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 99
           col: 12
          }
          end: {
           line: 99
           col: 56
          }
          text: "pets = petToApi(-> set of Pet ~[petId]> pet)"
         }
        }
       }
      }
      stmt: {
       assign: {
        name: "avgLifespan"
        expr: {
         unexpr: {
          op: NEG
          arg: {
           literal: {
            decimal: "1.0"
           }
           type: {
            primitive: DECIMAL
           }
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 100
             col: 27
            }
            end: {
             line: 100
             col: 30
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 100
             col: 27
            }
            end: {
             line: 100
             col: 30
            }
           }
          }
         }
         type: {
          primitive: INT
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 100
           col: 12
          }
          end: {
           line: 100
           col: 30
          }
          text: "avgLifespan = -1.0"
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 100
           col: 12
          }
          end: {
           line: 100
           col: 30
          }
          text: "avgLifespan = -1.0"
         }
        }
       }
      }
      stmt: {
       assign: {
        name: "index"
        expr: {
         call: {
          func: "autoinc"
          arg: {
           literal: {
            s: "Breed"
           }
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 101
             col: 28
            }
            end: {
             line: 101
             col: 35
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 101
             col: 28
            }
            end: {
             line: 101
             col: 35
            }
           }
          }
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 101
           col: 12
          }
          end: {
           line: 101
           col: 36
          }
          text: "index = autoinc(\"Breed\")"
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 101
           col: 12
          }
          end: {
           line: 101
           col: 36
          }
          text: "index = autoinc(\"Breed\")"
         }
        }
       }
      }
     }
     type: {
      set: {
       type_ref: {
        context: {
         appname: {
          part: "PetShopModelToApi"
         }
        }
        ref: {
         appname: {
          part: "PetShopApi"
         }
         path: "Breed"
        }
       }
      }
     }
     source_context: {
      file: "tests/petshop.sysl"
      start: {
       line: 96
       col: 8
      }
      end: {
       line: 102
       col: 10
      }
     }
     source_contexts: {
      file: "tests/petshop.sysl"
      start: {
       line: 96
       col: 8
      }
      end: {
       line: 102
       col: 10
      }
     }
    }
    source_context: {
     file: "tests/petshop.sysl"
     start: {
      line: 95
      col: 4
     }
     end: {
      line: 104
      col: 5
     }
     text: "!view breedToApi(breed <: set of PetShopModel.Breed, pet <: set of PetShopModelToApi.PetRankedByLeg):"
    }
    source_contexts: {
     file: "tests/petshop.sysl"
     start: {
      line: 95
      col: 4
     }
     end: {
      line: 104
      col: 5
     }
     text: "!view breedToApi(breed <: set of PetShopModel.Breed, pet <: set of PetShopModelToApi.PetRankedByLeg):"
    }
   }
  }
  views: {
   key: "employeeToApi"
   value: {
    param: {
     name: "employee"
     type: {
      set: {
       type_ref: {
        ref: {
         appname: {
          part: "PetShopModel"
         }
         path: "Employee"
        }
       }
      }
     }
    }
    ret_type: {
     set: {
      type_ref: {
       context: {
        appname: {
         part: "PetShopModelToApi"
        }
       }
       ref: {
        appname: {
         part: "PetShopApi"
        }
        path: "Employee"
       }
      }
     }
    }
    expr: {
     transform: {
      arg: {
       name: "employee"
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 89
         col: 8
        }
        end: {
         line: 89
         col: 16
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 89
         col: 8
        }
        end: {
         line: 89
         col: 16
        }
       }
      }
      scopevar: "."
      stmt: {
       assign: {
        name: "name"
        expr: {
         get_attr: {
          arg: {
           name: "."
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 90
             col: 12
            }
            end: {
             line: 90
             col: 18
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 90
             col: 12
            }
            end: {
             line: 90
             col: 18
            }
           }
          }
          attr: "name"
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 90
           col: 12
          }
          end: {
           line: 90
           col: 18
          }
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 90
           col: 12
          }
          end: {
           line: 90
           col: 18
          }
         }
        }
       }
      }
      stmt: {
       assign: {
        name: "dob"
        expr: {
         get_attr: {
          arg: {
           name: "."
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 91
             col: 12
            }
            end: {
             line: 91
             col: 17
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 91
             col: 12
            }
            end: {
             line: 91
             col: 17
            }
           }
          }
          attr: "dob"
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 91
           col: 12
          }
          end: {
           line: 91
           col: 17
          }
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 91
           col: 12
          }
          end: {
           line: 91
           col: 17
          }
         }
        }
       }
      }
      stmt: {
       assign: {
        name: "index"
        expr: {
         call: {
          func: "autoinc"
          arg: {
           literal: {
            s: "Employee"
           }
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 92
             col: 28
            }
            end: {
             line: 92
             col: 38
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 92
             col: 28
            }
            end: {
             line: 92
             col: 38
            }
           }
          }
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 92
           col: 12
          }
          end: {
           line: 92
           col: 39
          }
          text: "index = autoinc(\"Employee\")"
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 92
           col: 12
          }
          end: {
           line: 92
           col: 39
          }
          text: "index = autoinc(\"Employee\")"
         }
        }
       }
      }
     }
     type: {
      set: {
       type_ref: {
        context: {
         appname: {
          part: "PetShopModelToApi"
         }
        }
        ref: {
         appname: {
          part: "PetShopApi"
         }
         path: "Employee"
        }
       }
      }
     }
     source_context: {
      file: "tests/petshop.sysl"
      start: {
       line: 89
       col: 8
      }
      end: {
       line: 93
       col: 10
      }
     }
     source_contexts: {
      file: "tests/petshop.sysl"
      start: {
       line: 89
       col: 8
      }
      end: {
       line: 93
       col: 10
      }
     }
    }
    source_context: {
     file: "tests/petshop.sysl"
     start: {
      line: 88
      col: 4
     }
     end: {
      line: 95
      col: 5
     }
     text: "!view employeeToApi(employee <: set of PetShopModel.Employee):"
    }
    source_contexts: {
     file: "tests/petshop.sysl"
     start: {
      line: 88
      col: 4
     }
     end: {
      line: 95
      col: 5
     }
     text: "!view employeeToApi(employee <: set of PetShopModel.Employee):"
    }
   }
  }
  views: {
   key: "fibonacci"
   value: {
    param: {
     name: "n"
     type: {
      primitive: INT
     }
    }
    ret_type: {
     primitive: INT
    }
    attrs: {
     key: "patterns"
     value: {
      a: {
       elt: {
        s: "abstract"
       }
      }
     }
    }
    source_context: {
     file: "tests/petshop.sysl"
     start: {
      line: 112
      col: 4
     }
     end: {
      line: 112
      col: 48
     }
     text: "!view fibonacci(n <: int) -> int [~abstract]"
    }
    source_contexts: {
     file: "tests/petshop.sysl"
     start: {
      line: 112
      col: 4
     }
     end: {
      line: 112
      col: 48
     }
     text: "!view fibonacci(n <: int) -> int [~abstract]"
    }
   }
  }
  views: {
   key: "modelToApi"
   value: {
    param: {
     name: "petshop"
     type: {
      type_ref: {
       ref: {
        path: "PetShopModel"
       }
      }
     }
    }
    ret_type: {
     type_ref: {
      context: {
       appname: {
        part: "PetShopModelToApi"
       }
      }
      ref: {
       appname: {
        part: "PetShopApi"
       }
       path: "PetShop"
      }
     }
    }
    expr: {
     transform: {
      arg: {
       name: "petshop"
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 67
         col: 8
        }
        end: {
         line: 67
         col: 15
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 67
         col: 8
        }
        end: {
         line: 67
         col: 15
        }
       }
      }
      scopevar: "."
      stmt: {
       let: {
        name: "rankedPets"
        expr: {
         relexpr: {
          op: RANK
          target: {
           get_attr: {
            arg: {
             name: "."
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 68
               col: 29
              }
              end: {
               line: 68
               col: 42
              }
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 68
               col: 29
              }
              end: {
               line: 68
               col: 42
              }
             }
            }
            attr: "Pet"
            setof: true
           }
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 68
             col: 29
            }
            end: {
             line: 68
             col: 42
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 68
             col: 29
            }
            end: {
             line: 68
             col: 42
            }
           }
          }
          arg: {
           get_attr: {
            arg: {
             name: "."
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 68
               col: 82
              }
              end: {
               line: 68
               col: 90
              }
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 68
               col: 82
              }
              end: {
               line: 68
               col: 90
              }
             }
            }
            attr: "numLegs"
           }
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 68
             col: 82
            }
            end: {
             line: 68
             col: 90
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 68
             col: 82
            }
            end: {
             line: 68
             col: 90
            }
           }
          }
          arg: {
           get_attr: {
            arg: {
             name: "."
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 68
               col: 82
              }
              end: {
               line: 68
               col: 90
              }
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 68
               col: 82
              }
              end: {
               line: 68
               col: 90
              }
             }
            }
            attr: "numLegs"
           }
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 68
             col: 82
            }
            end: {
             line: 68
             col: 90
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 68
             col: 82
            }
            end: {
             line: 68
             col: 90
            }
           }
          }
          scopevar: "."
          descending: false
          attr_name: "legRank"
         }
         type: {
          set: {
           type_ref: {
            ref: {
             appname: {
              part: "PetShopModelToApi"
             }
             path: "PetRankedByLeg"
            }
           }
          }
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 68
           col: 12
          }
          end: {
           line: 68
           col: 102
          }
          text: "let rankedPets = .table of Pet rank<PetShopModelToApi.PetRankedByLeg>(.numLegs as legRank)"
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 68
           col: 12
          }
          end: {
           line: 68
           col: 102
          }
          text: "let rankedPets = .table of Pet rank<PetShopModelToApi.PetRankedByLeg>(.numLegs as legRank)"
         }
        }
       }
      }
      stmt: {
       assign: {
        name: "employees"
        expr: {
         call: {
          func: "employeeToApi"
          arg: {
           get_attr: {
            arg: {
             name: "."
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 70
               col: 38
              }
              end: {
               line: 70
               col: 56
              }
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 70
               col: 38
              }
              end: {
               line: 70
               col: 56
              }
             }
            }
            attr: "Employee"
            setof: true
           }
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 70
             col: 38
            }
            end: {
             line: 70
             col: 56
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 70
             col: 38
            }
            end: {
             line: 70
             col: 56
            }
           }
          }
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 70
           col: 12
          }
          end: {
           line: 70
           col: 57
          }
          text: "employees = employeeToApi(.table of Employee)"
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 70
           col: 12
          }
          end: {
           line: 70
           col: 57
          }
          text: "employees = employeeToApi(.table of Employee)"
         }
        }
       }
      }
      stmt: {
       assign: {
        name: "breeds"
        expr: {
         call: {
          func: "breedToApi"
          arg: {
           get_attr: {
            arg: {
             name: "."
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 71
               col: 32
              }
              end: {
               line: 71
               col: 47
              }
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 71
               col: 32
              }
              end: {
               line: 71
               col: 47
              }
             }
            }
            attr: "Breed"
            setof: true
           }
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 71
             col: 32
            }
            end: {
             line: 71
             col: 47
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 71
             col: 32
            }
            end: {
             line: 71
             col: 47
            }
           }
          }
          arg: {
           name: "rankedPets"
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 71
             col: 49
            }
            end: {
             line: 71
             col: 59
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 71
             col: 49
            }
            end: {
             line: 71
             col: 59
            }
           }
          }
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 71
           col: 12
          }
          end: {
           line: 71
           col: 60
          }
          text: "breeds = breedToApi(.table of Breed, rankedPets)"
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 71
           col: 12
          }
          end: {
           line: 71
           col: 60
          }
          text: "breeds = breedToApi(.table of Breed, rankedPets)"
         }
        }
       }
      }
      stmt: {
       assign: {
        name: "numLegs"
        expr: {
         relexpr: {
          op: SUM
          target: {
           get_attr: {
            arg: {
             name: "."
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 72
               col: 22
              }
              end: {
               line: 72
               col: 35
              }
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 72
               col: 22
              }
              end: {
               line: 72
               col: 35
              }
             }
            }
            attr: "Pet"
            setof: true
           }
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 72
             col: 22
            }
            end: {
             line: 72
             col: 35
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 72
             col: 22
            }
            end: {
             line: 72
             col: 35
            }
           }
          }
          arg: {
           binexpr: {
            op: COALESCE
            lhs: {
             get_attr: {
              arg: {
               name: "."
               source_context: {
                file: "tests/petshop.sysl"
                start: {
                 line: 72
                 col: 40
                }
                end: {
                 line: 72
                 col: 48
                }
               }
               source_contexts: {
                file: "tests/petshop.sysl"
                start: {
                 line: 72
                 col: 40
                }
                end: {
                 line: 72
                 col: 48
                }
               }
              }
              attr: "numLegs"
             }
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 72
               col: 40
              }
              end: {
               line: 72
               col: 48
              }
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 72
               col: 40
              }
              end: {
               line: 72
               col: 48
              }
             }
            }
            rhs: {
             literal: {
              i: 0
             }
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 72
               col: 52
              }
              end: {
               line: 72
               col: 53
              }
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 72
               col: 52
              }
              end: {
               line: 72
               col: 53
              }
             }
            }
           }
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 72
             col: 40
            }
            end: {
             line: 72
             col: 53
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 72
             col: 40
            }
            end: {
             line: 72
             col: 53
            }
           }
          }
          scopevar: "."
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 72
           col: 12
          }
          end: {
           line: 72
           col: 54
          }
          text: "numLegs = .table of Pet sum(.numLegs ?? 0)"
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 72
           col: 12
          }
          end: {
           line: 72
           col: 54
          }
          text: "numLegs = .table of Pet sum(.numLegs ?? 0)"
         }
        }
       }
      }
      stmt: {
       let: {
        name: "m"
        expr: {
         relexpr: {
          op: MIN
          target: {
           get_attr: {
            arg: {
             name: "."
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 74
               col: 20
              }
              end: {
               line: 74
               col: 33
              }
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 74
               col: 20
              }
              end: {
               line: 74
               col: 33
              }
             }
            }
            attr: "Pet"
            setof: true
           }
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 74
             col: 20
            }
            end: {
             line: 74
             col: 33
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 74
             col: 20
            }
            end: {
             line: 74
             col: 33
            }
           }
          }
          arg: {
           binexpr: {
            op: COALESCE
            lhs: {
             get_attr: {
              arg: {
               name: "."
               source_context: {
                file: "tests/petshop.sysl"
                start: {
                 line: 74
                 col: 38
                }
                end: {
                 line: 74
                 col: 46
                }
               }
               source_contexts: {
                file: "tests/petshop.sysl"
                start: {
                 line: 74
                 col: 38
                }
                end: {
                 line: 74
                 col: 46
                }
               }
              }
              attr: "numLegs"
             }
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 74
               col: 38
              }
              end: {
               line: 74
               col: 46
              }
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 74
               col: 38
              }
              end: {
               line: 74
               col: 46
              }
             }
            }
            rhs: {
             literal: {
              i: 0
             }
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 74
               col: 50
              }
              end: {
               line: 74
               col: 51
              }
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 74
               col: 50
              }
              end: {
               line: 74
               col: 51
              }
             }
            }
           }
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 74
             col: 38
            }
            end: {
             line: 74
             col: 51
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 74
             col: 38
            }
            end: {
             line: 74
             col: 51
            }
           }
          }
          scopevar: "."
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 74
           col: 12
          }
          end: {
           line: 74
           col: 52
          }
          text: "let m = .table of Pet min(.numLegs ?? 0)"
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 74
           col: 12
          }
          end: {
           line: 74
           col: 52
          }
          text: "let m = .table of Pet min(.numLegs ?? 0)"
         }
        }
       }
      }
      stmt: {
       let: {
        name: "a"
        expr: {
         relexpr: {
          op: AVERAGE
          target: {
           get_attr: {
            arg: {
             name: "."
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 75
               col: 20
              }
              end: {
               line: 75
               col: 33
              }
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 75
               col: 20
              }
              end: {
               line: 75
               col: 33
              }
             }
            }
            attr: "Pet"
            setof: true
           }
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 75
             col: 20
            }
            end: {
             line: 75
             col: 33
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 75
             col: 20
            }
            end: {
             line: 75
             col: 33
            }
           }
          }
          arg: {
           binexpr: {
            op: COALESCE
            lhs: {
             get_attr: {
              arg: {
               name: "."
               source_context: {
                file: "tests/petshop.sysl"
                start: {
                 line: 75
                 col: 42
                }
                end: {
                 line: 75
                 col: 50
                }
               }
               source_contexts: {
                file: "tests/petshop.sysl"
                start: {
                 line: 75
                 col: 42
                }
                end: {
                 line: 75
                 col: 50
                }
               }
              }
              attr: "numLegs"
             }
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 75
               col: 42
              }
              end: {
               line: 75
               col: 50
              }
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 75
               col: 42
              }
              end: {
               line: 75
               col: 50
              }
             }
            }
            rhs: {
             literal: {
              i: 0
             }
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 75
               col: 54
              }
              end: {
               line: 75
               col: 55
              }
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 75
               col: 54
              }
              end: {
               line: 75
               col: 55
              }
             }
            }
           }
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 75
             col: 42
            }
            end: {
             line: 75
             col: 55
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 75
             col: 42
            }
            end: {
             line: 75
             col: 55
            }
           }
          }
          scopevar: "."
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 75
           col: 12
          }
          end: {
           line: 75
           col: 56
          }
          text: "let a = .table of Pet average(.numLegs ?? 0)"
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 75
           col: 12
          }
          end: {
           line: 75
           col: 56
          }
          text: "let a = .table of Pet average(.numLegs ?? 0)"
         }
        }
       }
      }
      stmt: {
       let: {
        name: "pp"
        expr: {
         get_attr: {
          arg: {
           name: "."
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 78
             col: 21
            }
            end: {
             line: 78
             col: 34
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 78
             col: 21
            }
            end: {
             line: 78
             col: 34
            }
           }
          }
          attr: "Pet"
          setof: true
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 78
           col: 12
          }
          end: {
           line: 78
           col: 34
          }
          text: "let pp = .table of Pet"
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 78
           col: 12
          }
          end: {
           line: 78
           col: 34
          }
          text: "let pp = .table of Pet"
         }
        }
       }
      }
      stmt: {
       let: {
        name: "bb"
        expr: {
         binexpr: {
          op: TO_MATCHING
          lhs: {
           name: "pp"
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 79
             col: 21
            }
            end: {
             line: 79
             col: 23
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 79
             col: 21
            }
            end: {
             line: 79
             col: 23
            }
           }
          }
          rhs: {
           get_attr: {
            arg: {
             name: "."
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 79
               col: 27
              }
              end: {
               line: 79
               col: 42
              }
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 79
               col: 27
              }
              end: {
               line: 79
               col: 42
              }
             }
            }
            attr: "Breed"
            setof: true
           }
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 79
             col: 27
            }
            end: {
             line: 79
             col: 42
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 79
             col: 27
            }
            end: {
             line: 79
             col: 42
            }
           }
          }
          attr_name: "*"
         }
         type: {
          no_type: {}
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 79
           col: 12
          }
          end: {
           line: 79
           col: 42
          }
          text: "let bb = pp ~> .table of Breed"
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 79
           col: 12
          }
          end: {
           line: 79
           col: 42
          }
          text: "let bb = pp ~> .table of Breed"
         }
        }
       }
      }
      stmt: {
       let: {
        name: "yy"
        expr: {
         binexpr: {
          op: TO_NOT_MATCHING
          lhs: {
           name: "pp"
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 80
             col: 21
            }
            end: {
             line: 80
             col: 23
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 80
             col: 21
            }
            end: {
             line: 80
             col: 23
            }
           }
          }
          rhs: {
           get_attr: {
            arg: {
             name: "."
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 80
               col: 28
              }
              end: {
               line: 80
               col: 43
              }
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 80
               col: 28
              }
              end: {
               line: 80
               col: 43
              }
             }
            }
            attr: "Breed"
            setof: true
           }
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 80
             col: 28
            }
            end: {
             line: 80
             col: 43
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 80
             col: 28
            }
            end: {
             line: 80
             col: 43
            }
           }
          }
          attr_name: "*"
         }
         type: {
          no_type: {}
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 80
           col: 12
          }
          end: {
           line: 80
           col: 43
          }
          text: "let yy = pp !~> .table of Breed"
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 80
           col: 12
          }
          end: {
           line: 80
           col: 43
          }
          text: "let yy = pp !~> .table of Breed"
         }
        }
       }
      }
      stmt: {
       let: {
        name: "p"
        expr: {
         unexpr: {
          op: SINGLE_OR_NULL
          arg: {
           call: {
            func: ".any"
            arg: {
             name: "pp"
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 82
               col: 20
              }
              end: {
               line: 82
               col: 22
              }
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 82
               col: 20
              }
              end: {
               line: 82
               col: 22
              }
             }
            }
            arg: {
             literal: {
              i: 1
             }
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 82
               col: 27
              }
              end: {
               line: 82
               col: 28
              }
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 82
               col: 27
              }
              end: {
               line: 82
               col: 28
              }
             }
            }
           }
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 82
             col: 23
            }
            end: {
             line: 82
             col: 29
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 82
             col: 23
            }
            end: {
             line: 82
             col: 29
            }
           }
          }
         }
         type: {
          no_type: {}
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 82
           col: 12
          }
          end: {
           line: 82
           col: 42
          }
          text: "let p = pp any(1) singleOrNull"
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 82
           col: 12
          }
          end: {
           line: 82
           col: 42
          }
          text: "let p = pp any(1) singleOrNull"
         }
        }
       }
      }
      stmt: {
       let: {
        name: "b"
        expr: {
         navigate: {
          arg: {
           name: "p"
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 83
             col: 20
            }
            end: {
             line: 83
             col: 21
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 83
             col: 20
            }
            end: {
             line: 83
             col: 21
            }
           }
          }
          attr: "Breed"
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 83
           col: 12
          }
          end: {
           line: 83
           col: 30
          }
          text: "let b = p -> Breed"
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 83
           col: 12
          }
          end: {
           line: 83
           col: 30
          }
          text: "let b = p -> Breed"
         }
        }
       }
      }
      stmt: {
       let: {
        name: "pp2"
        expr: {
         navigate: {
          arg: {
           name: "b"
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 84
             col: 22
            }
            end: {
             line: 84
             col: 23
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 84
             col: 22
            }
            end: {
             line: 84
             col: 23
            }
           }
          }
          attr: "Pet"
          nullsafe: true
          setof: true
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 84
           col: 12
          }
          end: {
           line: 84
           col: 38
          }
          text: "let pp2 = b ?-> set of Pet"
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 84
           col: 12
          }
          end: {
           line: 84
           col: 38
          }
          text: "let pp2 = b ?-> set of Pet"
         }
        }
       }
      }
     }
     type: {
      type_ref: {
       context: {
        appname: {
         part: "PetShopModelToApi"
        }
       }
       ref: {
        appname: {
         part: "PetShopApi"
        }
        path: "PetShop"
       }
      }
     }
     source_context: {
      file: "tests/petshop.sysl"
      start: {
       line: 67
       col: 8
      }
      end: {
       line: 86
       col: 10
      }
     }
     source_contexts: {
      file: "tests/petshop.sysl"
      start: {
       line: 67
       col: 8
      }
      end: {
       line: 86
       col: 10
      }
     }
    }
    source_context: {
     file: "tests/petshop.sysl"
     start: {
      line: 66
      col: 4
     }
     end: {
      line: 88
      col: 5
     }
     text: "!view modelToApi(petshop <: PetShopModel):"
    }
    source_contexts: {
     file: "tests/petshop.sysl"
     start: {
      line: 66
      col: 4
     }
     end: {
      line: 88
      col: 5
     }
     text: "!view modelToApi(petshop <: PetShopModel):"
    }
   }
  }
  views: {
   key: "petToApi"
   value: {
    param: {
     name: "pet"
     type: {
      set: {
       type_ref: {
        ref: {
         appname: {
          part: "PetShopModelToApi"
         }
         path: "PetRankedByLeg"
        }
       }
      }
     }
    }
    ret_type: {
     set: {
      type_ref: {
       context: {
        appname: {
         part: "PetShopModelToApi"
        }
       }
       ref: {
        appname: {
         part: "PetShopApi"
        }
        path: "Pet"
       }
      }
     }
    }
    expr: {
     transform: {
      arg: {
       name: "pet"
       source_context: {
        file: "tests/petshop.sysl"
        start: {
         line: 105
         col: 8
        }
        end: {
         line: 105
         col: 11
        }
       }
       source_contexts: {
        file: "tests/petshop.sysl"
        start: {
         line: 105
         col: 8
        }
        end: {
         line: 105
         col: 11
        }
       }
      }
      scopevar: "."
      stmt: {
       assign: {
        name: "name"
        expr: {
         get_attr: {
          arg: {
           name: "."
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 106
             col: 12
            }
            end: {
             line: 106
             col: 18
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 106
             col: 12
            }
            end: {
             line: 106
             col: 18
            }
           }
          }
          attr: "name"
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 106
           col: 12
          }
          end: {
           line: 106
           col: 18
          }
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 106
           col: 12
          }
          end: {
           line: 106
           col: 18
          }
         }
        }
       }
      }
      stmt: {
       assign: {
        name: "dob"
        expr: {
         get_attr: {
          arg: {
           name: "."
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 107
             col: 12
            }
            end: {
             line: 107
             col: 17
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 107
             col: 12
            }
            end: {
             line: 107
             col: 17
            }
           }
          }
          attr: "dob"
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 107
           col: 12
          }
          end: {
           line: 107
           col: 17
          }
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 107
           col: 12
          }
          end: {
           line: 107
           col: 17
          }
         }
        }
       }
      }
      stmt: {
       assign: {
        name: "numLegs"
        expr: {
         get_attr: {
          arg: {
           name: "."
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 108
             col: 12
            }
            end: {
             line: 108
             col: 21
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 108
             col: 12
            }
            end: {
             line: 108
             col: 21
            }
           }
          }
          attr: "numLegs"
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 108
           col: 12
          }
          end: {
           line: 108
           col: 21
          }
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 108
           col: 12
          }
          end: {
           line: 108
           col: 21
          }
         }
        }
       }
      }
      stmt: {
       assign: {
        name: "legRank"
        expr: {
         call: {
          func: "fibonacci"
          arg: {
           get_attr: {
            arg: {
             name: "."
             source_context: {
              file: "tests/petshop.sysl"
              start: {
               line: 109
               col: 32
              }
              end: {
               line: 109
               col: 40
              }
             }
             source_contexts: {
              file: "tests/petshop.sysl"
              start: {
               line: 109
               col: 32
              }
              end: {
               line: 109
               col: 40
              }
             }
            }
            attr: "legRank"
           }
           source_context: {
            file: "tests/petshop.sysl"
            start: {
             line: 109
             col: 32
            }
            end: {
             line: 109
             col: 40
            }
           }
           source_contexts: {
            file: "tests/petshop.sysl"
            start: {
             line: 109
             col: 32
            }
            end: {
             line: 109
             col: 40
            }
           }
          }
         }
         source_context: {
          file: "tests/petshop.sysl"
          start: {
           line: 109
           col: 12
          }
          end: {
           line: 109
           col: 41
          }
          text: "legRank = fibonacci(.legRank)"
         }
         source_contexts: {
          file: "tests/petshop.sysl"
          start: {
           line: 109
           col: 12
          }
          end: {
           line: 109
           col: 41
          }
          text: "legRank = fibonacci(.legRank)"
         }
        }
       }
      }
     }
     type: {
      set: {
       type_ref: {
        context: {
         appname: {
          part: "PetShopModelToApi"
         }
        }
        ref: {
         appname: {
          part: "PetShopApi"
         }
         path: "Pet"
        }
       }
      }
     }
     source_context: {
      file: "tests/petshop.sysl"
      start: {
       line: 105
       col: 8
      }
      end: {
       line: 110
       col: 10
      }
     }
     source_contexts: {
      file: "tests/petshop.sysl"
      start: {
       line: 105
       col: 8
      }
      end: {
       line: 110
       col: 10
      }
     }
    }
    source_context: {
     file: "tests/petshop.sysl"
     start: {
      line: 104
      col: 4
     }
     end: {
      line: 112
      col: 5
     }
     text: "!view petToApi(pet <: set of PetShopModelToApi.PetRankedByLeg):"
    }
    source_contexts: {
     file: "tests/petshop.sysl"
     start: {
      line: 104
      col: 4
     }
     end: {
      line: 112
      col: 5
     }
     text: "!view petToApi(pet <: set of PetShopModelToApi.PetRankedByLeg):"
    }
   }
  }
  source_context: {
   file: "tests/petshop.sysl"
   start: {
    line: 65
   }
   end: {
    line: 120
    col: 23
   }
  }
  source_contexts: {
   file: "tests/petshop.sysl"
   start: {
    line: 65
   }
   end: {
    line: 120
    col: 23
   }
  }
 }
}
